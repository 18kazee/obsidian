
```ruby
i = gets.chomp.to_i
n = i.to_s.reverse.gsub(/(\d{3})(?=\d)/, '\1,').reverse
puts n
```

1. 最初に文字列を逆さまにすることで、`"7654321"` になります。
2. 正規表現 `/(\d{3})(?=\d)/` を使って、3桁の数字を探します。最初に `765` がマッチします。この部分が `\1` にキャプチャされます。
3. `(?=\d)` の条件が次に数字が続く場合にマッチするため、`5` の前にカンマを挿入します。結果として、`"765,4321"` になります。
4. 最後に、文字列を再び逆さまにして元の順序に戻します。最終的なフォーマットされた文字列は `"1,234,567"` になります。
   この正規表現は、3桁の数字の前にカンマを挿入することを意味します。